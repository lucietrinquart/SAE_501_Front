<div class="flex gap-5 p-5 bg-gray-200 h-screen">
  <!-- Bloc de gauche pour les données additionnelles -->
  <div class="w-1/3 bg-gray-300 p-5 rounded-lg shadow-md flex flex-col gap-5">
    <div class="h-1/5 bg-gray-600 rounded-lg"></div>
    <div class="h-4/5 bg-gray-600 rounded-lg overflow-y-auto">
      <!-- Liste des utilisateurs -->
      <ul class="space-y-2">
        @for (user of users; track user.id) {
        <li
          class="cursor-pointer px-4 py-2 bg-white border border-gray-300 rounded hover:bg-gray-100 transition duration-200"
          (click)="selectUser(user.id)">
          {{ user.username }}
        </li>
        }
      </ul>
    </div>
  </div>

  <!-- Bloc de droite pour le tableau -->
  <div class="flex flex-col w-full gap-5 overflow-auto">
    <!-- Onglets pour les semestres -->
    <ul class="flex gap-4 p-4 bg-gray-300 rounded-lg shadow-md">
      @for (sem of semestre; track sem.id) {
      <li
        class="cursor-pointer px-4 py-2 bg-white border border-gray-300 rounded hover:bg-blue-100 transition duration-200 [class.bg-blue-500]="
        selectedSemester="sem.id" (click)="selectSemester(sem.id)">
        Semestre {{ sem.id }}
      </li>
      }
    </ul>

    <div class="overflow-auto">
      <!-- Vérifier si un professeur est sélectionné -->
      @let isAnyResourceAvailable = false; <!-- Pour vérifier si une ressource est disponible pour le professeur -->

      <!-- Afficher les ressources en fonction du semestre -->
      @for (resources of resource; track resources.id) {
      <!-- Filtrer les ressources par semestre -->
      @if (+resources.semester_id === selectedSemester) {

      <!-- Initialiser une variable pour vérifier si le professeur a des charges de travail -->
      @let hasWorkload = false;

      <!-- Vérifier si le professeur sélectionné a des volumes pour cette ressource -->
      @for (userWork of userworkload; track userWork.id) {
      @if (userWork.resource_id === resources.id && userWork.user_id === selectedUserId) {
      @let hasWorkload = true;
      }
      }

      <!-- Si aucun professeur n'est sélectionné, afficher la ressource -->
      @if (!selectedUserId || hasWorkload) {
      <div class="flex flex-col w-full gap-5">
        <!-- Nom de la ressource -->
        <div class="flex flex-col w-full bg-gray-300 p-5 rounded-lg shadow-md overflow-hidden">
          <div class="bg-white text-black p-2 rounded-lg shadow-sm">{{ resources.name }}</div>

          <!-- Tableau avec les utilisateurs et leurs volumes -->
          <div class="bg-gray-200 p-5 rounded-lg shadow-sm overflow-auto">
            <table class="table-auto w-full text-left border border-gray-300 rounded-lg">
              <!-- En-têtes du tableau -->
              <thead class="bg-gray-400 text-white">
                <tr>
                  <th class="border px-4 py-2"></th> <!-- Cellule vide pour la première colonne -->
                  <th class="border px-4 py-2">CM</th>
                  <th class="border px-4 py-2">TD</th>
                  <th class="border px-4 py-2">TP</th>
                </tr>
              </thead>
              <tbody>
                @for (user of users; track user.id) {
                @if (!selectedUserId || user.id === selectedUserId) {
                @for (userWork of userworkload; track userWork.id) {
                @if (user.id === userWork.user_id && userWork.resource_id === resources.id) {
                <tr class="hover:bg-gray-100 transition duration-200">
                  <td class="border px-4 py-2">{{ user.username }}</td>
                  <td class="border px-4 py-2">{{ userWork.vol_cm }}</td>
                  <td class="border px-4 py-2">{{ userWork.vol_td }}</td>
                  <td class="border px-4 py-2">{{ userWork.vol_tp }}</td>
                </tr>
                @let isAnyResourceAvailable = true;
                }
                }
                }
                }
                <!-- Si le professeur n'a pas de volumes et que l'utilisateur est sélectionné -->
                @if (selectedUserId && !hasWorkload) {
                <tr>
                  <td colspan="4" class="border px-4 py-2 text-center">Aucune donnée disponible pour cette ressource.
                  </td>
                </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      </div>
      }
      }
      }

      <!-- Si aucun utilisateur n'est sélectionné et aucune ressource n'est disponible -->
      @if (selectedUserId && !isAnyResourceAvailable) {
      <div class="flex justify-center">
        <p>Aucune ressource disponible pour le professeur sélectionné.</p>
      </div>
      }
    </div>
  </div>
</div>

<!-- Existing page content -->
<!-- <app-form-create-semester></app-form-create-semester> -->
<!-- <app-form-create-resource></app-form-create-resource> -->
<!-- <app-form-create-user></app-form-create-user> -->